{% extends "blog/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class="content-section">
    <form method="POST">
        {% csrf_token %}
        <fieldset class="form-group">
            <legend class="border-bottom mb-4">Create New Post</legend>
            {{ form|crispy }}
        </fieldset>
        <div class="form-group">
            <button class="btn btn-outline-info" type="submit">Create Post</button>
            <a class="btn btn-outline-secondary ml-2" href="{% url 'blog-home' %}">Cancel</a>
        </div>
    </form>
</div>

<script>
function toggleCustomCategory(categoryValue) {
    const customCategoryField = document.getElementById('id_custom_category');
    const customCategoryLabel = document.querySelector('label[for="id_custom_category"]');
    const customCategoryHelp = customCategoryField.parentNode.querySelector('.form-text');
    
    if (categoryValue === 'other') {
        customCategoryField.style.display = 'block';
        customCategoryField.required = true;
        if (customCategoryLabel) customCategoryLabel.style.display = 'block';
        if (customCategoryHelp) customCategoryHelp.style.display = 'block';
    } else {
        customCategoryField.style.display = 'none';
        customCategoryField.required = false;
        customCategoryField.value = '';
        if (customCategoryLabel) customCategoryLabel.style.display = 'none';
        if (customCategoryHelp) customCategoryHelp.style.display = 'none';
    }
}

// Initialize the form state when page loads
document.addEventListener('DOMContentLoaded', function() {
    const categorySelect = document.getElementById('id_category');
    if (categorySelect) {
        toggleCustomCategory(categorySelect.value);
    }
});
</script>
{% endblock content %}